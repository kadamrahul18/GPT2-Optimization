{
  "schema_version": "2.0",
  "run_id": "run2",
  "timestamp_utc": "2024-01-01T00:00:10Z",
  "git_commit": "unknown",
  "command_line": "python src/gpt2.py --run_type baseline",
  "env": {
    "python_version": "3.11.0",
    "torch_version": "2.1.0",
    "transformers_version": "4.40.0",
    "deepspeed_version": "0.12.0",
    "cuda_version": "12.1"
  },
  "host": {
    "hostname": "example-host",
    "os": "Linux-6.0.0"
  },
  "hardware": {
    "gpu_name": "NVIDIA T4",
    "gpu_count_visible": 1,
    "world_size": 1
  },
  "training_config": {
    "model_name": "gpt2",
    "model_size": "n_layer=12, n_head=12, n_embd=768",
    "seq_len": 512,
    "epochs": 1,
    "micro_batch_size_per_gpu": 4,
    "grad_accum_steps": 4,
    "global_batch_size": 16,
    "lr": 0.0001,
    "optimizer": "AdamW",
    "precision": "fp16_torch_amp",
    "zero_stage": 0,
    "dataset_name": "train_small",
    "dataset_subset_sizes": {
      "train": 100,
      "val": 20
    },
    "deepspeed_enabled": false
  },
  "deepspeed_config": {
    "path": "src/deepspeed_config.json",
    "sha256": "deadbeef",
    "selected": {
      "fp16_enabled": true,
      "wall_clock_breakdown": true
    }
  },
  "epochs": [
    {
      "epoch_idx": 1,
      "epoch_wall_time_sec": 11.0,
      "steps": 100,
      "micro_steps": 100,
      "optimizer_steps": 25,
      "tokens_processed_global": 200000,
      "tokens_per_sec_global": 95.0,
      "train_loss_avg_global": 2.0,
      "val_loss_avg_global": 2.1,
      "max_cuda_mem_allocated_bytes_rank0": 100,
      "max_cuda_mem_reserved_bytes_rank0": 200,
      "step_time_mean_sec": 0.1,
      "step_time_p50_sec": 0.1,
      "step_time_p95_sec": 0.1,
      "dataload_time_mean_sec": 0.01
    }
  ],
  "summary": {
    "total_wall_time_sec": 11.0,
    "mean_tokens_per_sec_global": 95.0,
    "best_val_loss": 2.1
  },
  "completion": {
    "run_complete_file": "RUN_COMPLETE.txt",
    "printed_marker": true,
    "timestamp_utc": "2024-01-01T00:00:00Z"
  }
}